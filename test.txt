Final Version

updated from Toirtoise git

more changes made


